# Development Dockerfile for Frontend with Hot Reloading
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Add package files (only for layer cache; actual source is mounted in compose)
COPY package*.json ./

# Configure npm to avoid peer dep conflicts common in dev
ENV npm_config_legacy_peer_deps=true

# Expose port 3000
EXPOSE 3000

# Set environment variables for hot reloading
ENV CHOKIDAR_USEPOLLING=true
ENV WATCHPACK_POLLING=true
ENV FAST_REFRESH=true

# Install deps on container start (works with bind mounts and avoids build-time failures)
# Always run npm install in dev to ensure dependencies are present in the anonymous node_modules volume
CMD ["sh", "-c", "npm install --no-audit --no-fund && npm start"]
